/* ===== Bright Pop Theme v3.1 (HUD/Settings 可読性強化) ===== */
:root {
  --bg-top: #e1f5fe;        /* 明るい水色 */
  --bg-bottom: #b3e5fc;     /* すこし濃い水色 */
  --text: #333;
  --panel: #fff8d9;         /* HUDバッジ背景 */
  --shadow: 0 8px 24px rgba(0,0,0,.10);

  /* カード/ボタン/バー */
  --card-bg: #fffdf5;       /* 問題カードの背景 */
  --card-border: #ffcc00;   /* カードの枠 */
  --card-border-hover: #ffd84d;
  --accent: #ff9800;        /* 発射ボタン */
  --accent-2: #66bb6a;      /* Remainバー */
  --alert: #ef5350;         /* Timeバー */
}

html, body {
  height: 100%;
  margin: 0;
  color: var(--text);
  font-family: "M PLUS Rounded 1c", "Noto Sans JP", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  background: linear-gradient(180deg, var(--bg-top), var(--bg-bottom));
}

/* ===== HUD（上部ステータス） ===== */
[data-hud], .hud, header .status, .top-bar {
  display: flex;
  flex-wrap: wrap;
  gap: .5rem;
  padding: .6rem .8rem;
  align-items: center;
}
.hud-left, .hud-right { display: flex; gap: .6rem; }
.hud-right { margin-left: auto; }

[data-hud] > *, .hud > *, header .status > *, .top-bar > *,
.hud-left > *, .hud-right > * {
  background: var(--panel);
  padding: .35rem .65rem;
  border-radius: 999px;
  font-weight: 700;
  box-shadow: var(--shadow);
  color: #000 !important;          /* ← HUD文字は黒固定 */
  text-shadow: none !important;
}

/* Remain/Time の色差を強調 */
.badge-remain { background: #e9f7ee !important; }
.badge-time   { background: #ffe9e9 !important; }

/* ===== 問題カード ===== */
.problem-card, .question, .question-card {
  background: var(--card-bg);
  border: 3px solid var(--card-border);
  border-radius: 18px;
  padding: .8rem 1.1rem;
  font-size: clamp(18px, 3.4vw, 28px);
  font-weight: 800;
  letter-spacing: .5px;
  display: inline-block;
  color: #222;
  box-shadow: var(--shadow);
  transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
  text-shadow: 1px 1px 0 rgba(255,255,255,.4);
  user-select: none;
}
.problem-card:hover, .question:hover, .question-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 28px rgba(0,0,0,.16), 0 0 12px rgba(255,220,80,.6);
  border-color: var(--card-border-hover);
}
.problem-card.is-active, .question.is-active, .question-card.is-active {
  border-color: #ffcf00;
  transform: translateY(-3px) scale(1.02);
}

/* ===== 回答パネル（下部） ===== */
#answer-panel, .answer-panel, .bottom-input {
  position: fixed;
  left: 50%;
  bottom: 20px;
  transform: translateX(-50%);
  display: flex;
  gap: .6rem;
  align-items: center;
  justify-content: center;
  background: rgba(255,255,255,.88);
  padding: .6rem .8rem;
  border-radius: 16px;
  box-shadow: var(--shadow);
  backdrop-filter: blur(4px);
}
#answer-panel input[type="text"],
.answer-panel input[type="text"],
.bottom-input input[type="text"] {
  min-width: min(60vw, 520px);
  height: 2.8rem;
  font-size: clamp(18px, 2.6vw, 22px);
  padding: .6rem .8rem;
  border-radius: 12px;
  border: 2px solid #eee;
  outline: none;
}
#answer-panel input[type="text"]::placeholder { color: #999; }

/* ===== 発射ボタン ===== */
#fire-btn, .fire-btn, button.launch, button.fire {
  height: 2.8rem;
  font-size: clamp(16px, 2.2vw, 20px);
  font-weight: 900;
  padding: 0 1.4rem;
  border: none;
  border-radius: 14px;
  background: var(--accent);
  color: #fff;
  cursor: pointer;
  box-shadow: var(--shadow);
  transition: transform .08s ease, filter .08s ease;
}
#fire-btn:hover, .fire-btn:hover, button.launch:hover, button.fire:hover {
  transform: translateY(-1px);
  filter: brightness(1.04);
}

/* ===== 進捗バー ===== */
.progress, .remain-bar, .time-bar {
  position: relative;
  width: min(46vw, 560px);
  height: 14px;
  border-radius: 999px;
  overflow: hidden;
  background: #fff;
  box-shadow: var(--shadow);
}
.progress > .fill, .remain-bar > .fill { background: var(--accent-2); height: 100%; }
.time-bar > .fill { background: var(--alert); height: 100%; }
.progress .label, .remain-bar .label, .time-bar .label {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 800;
  color: #333;
}

/* ===== 背景 ===== */
.stage-background, .playground, .arena { opacity: .8; }

/* ===== モバイル ===== */
@media (max-width: 640px) {
  #answer-panel, .answer-panel, .bottom-input { bottom: 12px; gap: .5rem; }
  #answer-panel input[type="text"] { min-width: min(78vw, 420px); }
}

/* ===== コントラストユーティリティ ===== */
.on-dark {
  color: #fff !important;
  text-shadow:
    0 2px 4px rgba(0,0,0,.45),
    0 0 2px rgba(0,0,0,.55);
}
.on-light {
  color: #222 !important;
  text-shadow: 0 1px 0 rgba(255,255,255,.5);
}

/* ===== ボタンは常に白文字 ===== */
button, .btn, button * {
  color: #fff !important;
  text-shadow: 0 1px 2px rgba(0,0,0,.35);
}

/* ===== チップ・ピルは黒固定 ===== */
.chip, .pill {
  color: #000 !important;
  text-shadow: none !important;
}

/* ===== 暗いオーバーレイ上の文字だけ白固定 ===== */
.overlay, .pause-overlay, .stage-clear, .modal-dark {
  /* ダーク背景のコンテナ（必要ならアプリ側のクラスに合わせてください） */
}
.overlay .overlay-text,
.pause-overlay .pause-text,
.stage-clear .stage-clear-title,
.overlay h1, .overlay h2,
.modal-dark .modal-title,
.modal-dark h1, .modal-dark h2 {
  color:#fff !important;
  text-shadow:0 3px 8px rgba(0,0,0,.55), 0 0 6px rgba(0,0,0,.55);
}

/* ===== HUD/回答パネル内はボタン以外すべて黒固定（SELECTED含む） ===== */
[data-hud] :not(button):not(.btn),
.hud :not(button):not(.btn),
header .status :not(button):not(.btn),
.top-bar :not(button):not(.btn),
#answer-panel :not(button):not(.btn),
.answer-panel :not(button):not(.btn),
.bottom-input :not(button):not(.btn) {
  color: #000 !important;
  text-shadow: none !important;
}

/* ===== Settings（設定）画面は黒文字で読みやすく ===== */
.settings, [data-settings], .settings-panel, .settings-section, .settings-modal {
  color:#000 !important;
  text-shadow:none !important;
}
.settings .section-title,
[data-settings] .section-title,
.settings h1, .settings h2,
[data-settings] h1, [data-settings] h2 {
  color:#1b3a57 !important;   /* 見出しは濃い青 */
  text-shadow:none !important;
  opacity:1 !important;
}
.settings label, [data-settings] label,
.settings small, [data-settings] small,
.settings .desc, [data-settings] .desc,
.settings .help, [data-settings] .help,
.settings .hint, [data-settings] .hint {
  color:#000 !important;
  text-shadow:none !important;
  opacity:1 !important;
}
/* スライダー数値やチェック横のテキストも黒 */
.settings input, [data-settings] input,
.settings .value, [data-settings] .value,
.settings .unit,  [data-settings] .unit {
  color:#000 !important;
}
